{"version":3,"file":"UNSAFE_Modal.js","sources":["../../src/UNSAFE_Modal/hooks/useModal.ts","../../src/UNSAFE_Modal/ModalBackdrop.tsx","../../src/UNSAFE_Modal/ModalContainer.tsx","../../src/UNSAFE_Modal/Modal.tsx"],"sourcesContent":["\nimport { useRef, useCallback, useEffect } from \"preact/compat\";\n\nexport type UseModalProps = Readonly<{\n    /**\n     * Determines whether the Modal is open.\n     */\n    isOpen : boolean;\n    /**\n     * On backdrop click callback.\n     */\n    onBackdropClick? : () => void;\n  }>;\n  \n  /**\n   *\n   * @param props\n   */\n  export const useModal = (props: UseModalProps) => {\n    \n    const {\n      isOpen,\n      onBackdropClick : onBackdropClickProp,\n    } = props;\n\n    const modalRef = useRef<HTMLDivElement>(null)\n\n    const mouseDownTarget = useRef<EventTarget | null>(null);\n\n    const onMouseDown = useCallback( (event: MouseEvent) => {\n        if (modalRef.current === event.target) {\n          mouseDownTarget.current = event.target\n        }\n      }, []);\n\n    const onBackdropClick = useCallback( (event: MouseEvent) => {\n      \n      if (modalRef.current === event.target) {\n        event.stopPropagation()\n        // event should originate on the same target\n        if (mouseDownTarget.current === event.target) {\n          onBackdropClickProp?.()\n        }\n      }\n    }, [onBackdropClickProp] )\n\n    useEffect(() => {\n      const modal = modalRef.current;\n\n      if (modal) {\n        modal.addEventListener('mousedown', onMouseDown);\n        modal.addEventListener('click', onBackdropClick); \n\n        return () => {\n          modal.removeEventListener('mousedown', onMouseDown);\n          modal.removeEventListener('click', onBackdropClick);\n        }\n      }\n\n      return () => {};\n    }, [isOpen, onMouseDown, onBackdropClick]);\n\n    return {\n      modalRef,\n    }\n\n  };\n  \n  export default useModal;\n  ","import { cssProps } from '@oracle/oraclejet-cssprops';\n\nconst styles = {\n  base: cssProps`${{\n    position: 'absolute',\n    top: '0',\n    right: '0',\n    bottom: '0',\n    left: '0',\n    backgroundColor: 'rgba(0,0,0,.5)'\n  }}`\n};\n\nconst ModalBackdrop = () => <div class={styles.base} />;\n\nexport default ModalBackdrop;\n","import { forwardRef } from 'preact/compat';\nimport { cssProps } from '@oracle/oraclejet-cssprops';\nimport { HTMLAttributesSignalExcluded } from '../utils/UNSAFE_attributeUtils';\n\ntype IntrinsicProps = Pick<HTMLAttributesSignalExcluded<HTMLDivElement>, 'children'>;\ntype Props = IntrinsicProps;\n\nconst styles = {\n  base: cssProps`${{\n    position: 'absolute',\n    inset: 0,\n    backgroundColor: 'transparent',\n    height: '100%',\n    margin: '0 auto',\n    maxWidth: 'calc(100% - 0.01px) !important',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }}`\n};\n\nconst ModalContainer = forwardRef<HTMLDivElement, Props>(({ children }, ref) => (\n  <div class={styles.base} ref={ref}>\n    {children}\n  </div>\n));\nModalContainer.displayName = 'Forwarded<ModalContainer>';\n\nexport default ModalContainer;\n","import { RefObject } from 'preact';\nimport { useModal } from './hooks/useModal';\nimport { FocusTrap } from '../UNSAFE_FocusTrap';\nimport { Layer } from '../UNSAFE_Layer';\nimport ModalBackdrop from './ModalBackdrop';\nimport ModalContainer from './ModalContainer';\nimport { cssProps } from '@oracle/oraclejet-cssprops';\nimport { HTMLAttributesSignalExcluded } from '../utils/UNSAFE_attributeUtils';\n\ntype IntrinsicProps = Pick<HTMLAttributesSignalExcluded<HTMLDivElement>, 'children'>;\ntype UseModalProps = Parameters<typeof useModal>[0];\ntype Props = UseModalProps &\n  IntrinsicProps & {\n    /**\n     * Optional Ref to an element to focus on when component mounts\n     * @default - undefined - behavior is to focus on first tabbableElement\n     */\n    autoFocusRef?: RefObject<HTMLElement>;\n\n    /**\n     * Optional Ref to element to focus on when component un-mounts\n     * @default - undefined - behavior is to focus on the original activeElement when focus trap was enabled\n     */\n    restoreFocusRef?: RefObject<HTMLElement>;\n  };\n\nconst styles = {\n  base: cssProps`${{\n    position: 'fixed',\n    top: '0',\n    right: '0',\n    bottom: '0',\n    left: '0'\n  }}`\n};\n\nconst ModalWrapper = ({ children }: IntrinsicProps) => <div class={styles.base}>{children}</div>;\n\nconst Modal = ({ autoFocusRef, children, isOpen, onBackdropClick, restoreFocusRef }: Props) => {\n  const { modalRef } = useModal({ isOpen, onBackdropClick });\n\n  return isOpen ? (\n    <Layer>\n      <ModalWrapper>\n        <ModalBackdrop />\n        <ModalContainer ref={modalRef}>\n          <FocusTrap autoFocusRef={autoFocusRef} restoreFocusRef={restoreFocusRef}>\n            {children}\n          </FocusTrap>\n        </ModalContainer>\n      </ModalWrapper>\n    </Layer>\n  ) : null;\n};\n\nexport default Modal;\n"],"names":["styles","ModalBackdrop","_jsx","class","base","ModalContainer","forwardRef","children","ref","Object","assign","displayName","ModalWrapper","Modal","autoFocusRef","isOpen","onBackdropClick","restoreFocusRef","modalRef","useModal","Layer","_jsxs","FocusTrap"],"mappings":"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"}